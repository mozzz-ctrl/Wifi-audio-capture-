 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WebRTC Live Audio Stream</title>
</head>
<body>
  <h2>WebRTC Live Audio Streaming (Sender & Receiver)</h2>

  <button id="startCapture">Start Capturing Microphone</button>
  <button id="createOffer" disabled>Create Offer</button>

  <h3>Local SDP Offer</h3>
  <textarea id="localOffer" rows="6" cols="50" placeholder="Offer will appear here"></textarea>

  <h3>Remote SDP Answer</h3>
  <textarea id="remoteAnswer" rows="6" cols="50" placeholder="Paste remote answer here"></textarea>
  <button id="setRemoteAnswer">Set Remote Answer</button>

  <h3>Remote SDP Offer</h3>
  <textarea id="remoteOffer" rows="6" cols="50" placeholder="Paste remote offer here"></textarea>
  <button id="setRemoteOffer">Set Remote Offer</button>

  <h3>Local SDP Answer</h3>
  <textarea id="localAnswer" rows="6" cols="50" placeholder="Local answer will appear here"></textarea>

  <h3>Remote Audio</h3>
  <audio id="remoteAudio" controls autoplay></audio>

  <script>
    let pc = new RTCPeerConnection();
    let localStream;

    const startCaptureButton = document.getElementById('startCapture');
    const createOfferButton = document.getElementById('createOffer');
    const localOfferText = document.getElementById('localOffer');
    const remoteAnswerText = document.getElementById('remoteAnswer');
    const setRemoteAnswerButton = document.getElementById('setRemoteAnswer');
    const remoteOfferText = document.getElementById('remoteOffer');
    const setRemoteOfferButton = document.getElementById('setRemoteOffer');
    const localAnswerText = document.getElementById('localAnswer');
    const remoteAudio = document.getElementById('remoteAudio');

    // Handle remote tracks (incoming audio)
    pc.ontrack = event => {
      remoteAudio.srcObject = event.streams[0];
    };

    // Capture microphone audio
    startCaptureButton.onclick = async () => {
      localStream = await navigator.mediaDevices.getUserMedia({ audio: true });
      localStream.getTracks().forEach(track => pc.addTrack(track, localStream));
      alert('Microphone stream started and added to WebRTC connection');
      createOfferButton.disabled = false;
    };

    // Create an SDP offer (Sender role)
    createOfferButton.onclick = async () => {
      const offer = await pc.createOffer();
      await pc.setLocalDescription(offer);
      localOfferText.value = JSON.stringify(offer);
    };

    // Set remote SDP answer (Sender waits for this)
    setRemoteAnswerButton.onclick = async () => {
      const answer = JSON.parse(remoteAnswerText.value);
      await pc.setRemoteDescription(answer);
      alert('Remote answer set, connection should be established');
    };

    // Set remote offer (Receiver role)
    setRemoteOfferButton.onclick = async () => {
      const offer = JSON.parse(remoteOfferText.value);
      await pc.setRemoteDescription(offer);
      const answer = await pc.createAnswer();
      await pc.setLocalDescription(answer);
      localAnswerText.value = JSON.stringify(answer);
      alert('Local answer created, send this back to remote sender');
    };
  </script>
</body>
</html>
